---
title: 多重ディスパッチとvisitorパターン
layout: post
---

ちゃんと読んでなかったのでメモする。

相対的に junior なひとになにかいうとき、この本を参照点にすると「読んどいて」で済むし説得力をもたせやすい。

そういう指摘をしたくなったときに、「リーダブルコードに書いてあった気がするけどどこだっけ...」を解消するためのメモとする。

なので自分にとって既に新しくない情報でも、上記の indexing のために役立ちそうなことはメモする。

# 1 章

この本は可読性に焦点を当てている。

拡張性とかにはフォーカスしてなくて、自分の認識だと両者はときに相反する。

# 2 章 名前に情報を詰め込む

- 適切な抽象度の名前をつける
- 値の単位を名前に含める
  - ex. delay_secs
- 変数の意味を間違えた場合のリスクが大きい情報は変数に含める
  - ex. plaintext_password
- その変数が何なのか理解するために必要な情報はスコープによって異なる
- プロジェクト固有の省略は避ける
  - 個人で spell checker をつかっているけど、CI に組み込んでもいいかもなー、と思った。うまく運用すればドメイン知識の辞書になるかも
- 名前のフォーマットで情報を伝える
  - これは個人的には現代ではむしろ避けた方がいい場面も多そうと思う。エディタで簡単にそれが何なのか判明するので。private 変数にアンダースコアの prefix をつけたくない。

# 3 章 誤解されにくい名前をつける

- filter はわかりにくいとのことだけど js とかでは組み込みで filter あるから誤解しにくそう
- length は文字数なのかバイト数なのか不明瞭
- limit は最大なのか最小なのか不明瞭
- 「x 以下」のとき、x は max とか last で。「x 未満」は(begin/)end をつかう場合が多い
- bool は is/has/can/should などの prefix をつけよ
- 否定形の命名を避けよ
- getHoge は軽量アクセサを期待させるので重い処理は書かない

# 4 章 見ためを整える

- 整列とかはフォーマッタに任せたいところ
- 何かを並べるときは順番に意味をもたせよう
- 宣言をブロックにまとめる
- コードを段落に分割する

# 5 章 何をコメントするか

- 全体像や意図に関するコメントをつける
- 定数をその値にした背景をコメントする

# 6 章 どうコメントするか

- 読み手がいろんなことに気づけるような意図を込めた例示をコメントする

# 7 章 制御フロー

- 値の比較では左辺に調査対象、右辺に比較対象を書く
  - 個人的には「左が小さく右が大きい」というのも好きだ。
    - 例えば「x が a より大きく b より小さい」は`a < x && x < b`
    - あと、どちらが調査対象かが明瞭じゃない場合もあるし
- if/else の条件は肯定形で書く
- do/while は条件が最後に書かれるためわかりにくいので、while で書き直す
- ネストはガード節での return や contiue で浅くする

# 8 章 巨大な式を分割する

- 範囲の重複の例、以前まったく同じことやった
- 説明変数、要するに概念を抽出してそれに形を与える

# 9 章

- 変数のスコープはなるべく小さくする
- メンバ変数をつかわないなら static なメソッドにする
- js では、特定のメソッドからしか参照しない変数をクロージャで包むというテクニックがある
- js で未宣言変数がグローバルになったちゃうのは`use strict;`で防げるやつね
- 変数はなるべく immutable にする

# 10 章

# 11 章

# 12 章

# 13 章

# 14 章

# 15 章

- なにができているか
- なにができていないか
- どうする/どうなることを期待しているか
- こちらとしてどういう働きかけをトライしてみるか

# me

メンバーを育てる、かな。
解像度を上げて戦略的に働きかける。

メンバーの解像度をあげる（ためにメモしたり思考を整理する）ことに週 1,2h くらいつかおうかな。業務のひとつとしてちゃんと位置づけるといい気がする。

いままではレトロでの fb のためにメモするくらいだったけど、もっと詳細に。

例えば検証データ移行ができないね、

僕自身、こうやって思考を整理することがいま多いし、その必要を感じているのは、トランジションの真っ最中だからなのかもしれない。

pj 序盤/中盤の動きについて学びを得て再現性を高めることができている？

- わく夏も poc つくっちゃう動きできて、それはよかった。一般的にいい動きということができそう
  - 実装上の不確実性を下げるというのもあるけど、なんかみんなをそういうモードにさせる、というのが大きな力な気がする
  - そして、これとこれがあって優先順位がこれだね、とか
  - データでつくるべきものを見極める、というのがいい動きっぽい、というのも今回の学び
    - わく春でもそういうことをやり得ただろうか？

デメリットの大きさ
例えば英語の学習効率がどれだけ下がるかは見ようと思えばできた気がする。

- わく夏、4 月のどこかで

わく夏、期限の調整が容易なのと、実装のボリュームがそこまでなさそうなのでわりとふわっと動いている。
よっちの意図はまあまあ汲めているつもりではある。

# akindo

わく春を通じてプロジェクトマネジメントにつよくなった、というみやっちのレトロかなにかの振り返りがあった。
何が起きたのだろうか？？
これは蟻大会でちょっときいてみたい。

ひょっとしたら「toshi-san が dp 的なことをやってくれて自分がやらないのは当然だった」けど
「takacy がやってるなら自分もやったほうがいい/やれるのかな」という意識で自分ごとになったのかもしれない。

わく春は 2023-01 からで、僕が DP になったのと同時期。

2023-05-10 かな、検証データ移行ができねえ、となったときに
レトロをやめてこっちやりましょう、とか、
いったんこっちの solution が動いているけど、それがこけた場合のリスクを踏まえると
フォールバックの準備も優先度高く動いていきましょう、みたいな判断が僕によってなされている。
そしてそれは「ちょっと遅い」とかじゃなくて、たぶんほっといたらそのままレトロやって、数時間たって

あと翌週 05-17 に、翌日の検証のためのリスクが極めて大きく残っている状態で、
blue の飲み会にそのまま行って、その夜も何も動きをしていなかったようにみえる。

正常化バイアスを外せてないかんじ。

なんか隠れているリスクに対して

- 適切な行動がない
- （ほぼ確実に）隠れているリスクを、その大きさを認識できていない

今回のデータ移行の件は、akindo の成長のチャンスかもしれない。

リスクに対する認識と行動の欠如は、データ移行みたいな短期だけじゃなくて、長期にもいえるかも？

やっちまえ、が足りないかもしれない？
とりあえず実装しちゃう、みたいな。
わく春は僕がたしかフォーカス単元を唯一の短期目標とする、みたいな poc つくった。
わく夏はたしか

ただそれは「言われてないのに動き出す」がやりにくいからかもしれない。

何ができたら DP をできるのか、を明らかにしておくのがいいかも。
それができれば、DP に向けてひとつひとつ近づいてもらうことを考えられる。

責任をもつ、というのはなんていうか最後にちょんとのればいいんです。

pj スコープで物事をみる、かな。
正直、わく夏という pj とか、わく春全面展開とかくらいのスコープでしか僕はものごとを考えられてない。

- 不確実性を下げるために
  - 不確実な事項を発見する（逐次）
  - 不確実性を評価して優先順位をつけて（これはここらへんまでやらないとまずい、みたいに見立てて組み立てる）
  - 不確実性を下げるためのアクションをとれる
    - チームを動員できる（合議による意思決定と巻き込みとサポート）
    - 自分で手を動かして解決できる

これだけかもな。
具体的に僕がやったことは？
それらをメンバができそうか？メンバにそれに対するチャレンジの機会を与えられそうか？

これらについて、メンバの現状を見立ててみたい。
都度代わりうるものだし、上限があるものでもないので、80 点とかつけるのは避けたほうがよさそう。
相対的に各項目のどこが弱いのか、各項目が「全然これから」「概ねいいけど惜しい」「ばっちり、おまかせできる」くらいの

プロセス改善みたいな視点もあってよさそう。
レトロで

- 振り返りのきっかけとなるふせんをだせているか
- 振り返りの議論を深めることができているか
- 議論を通じて、共通認識をつくったり、ネクストアクションをつくったりすることができているか

# sekken

2022-08 入社、9 月くらいから akindo.
いま 2023-05

テストとか定量分析に対する興味はかなり初期から抱いていた。

2023-05, 最近わく夏の定量分析に入っていきたい、巻き込んでくれといっていた
テストを書くのを朝活でやっている

いいところはファシリをやってもらうと安定感があるな。

sekken が入ってからは新中学英語、うさかめ、わく春、わく夏かな。

ざっくりだけど、「進め方おいおい。。」と思って指摘することがかなり減ってきた
ただ仕様をきっちり確認して実装する、というのがけっこう怪しかった
まったく気づいてないケースもあるけど、「これでいいんじゃね」で ux に確認とらない、というケースがけっこうある印象。

最近も、仕様をきっちり実現してないのあった。わく夏検証のやつ
実装してすぐ ux にスクショ送るなり edge 触ってもらうなりのアクションがあるといいんじゃないかなーと。

なんかどっちかな？となったときに「おれが考えたのがいい solution だ、おれがこれでいいと思うんだからいいだろう」という自信がある気がする。
そしてそれは必ずしも当たってない。
わく夏でもカードの色とか

これは何なのだろうか？
言われたら面倒だからとりあえずタスクを done させたい、という気持ちからそうしているのだろうか？
とりあえずタスクを終えなければ、という焦り？

なんて言葉でいってたかな、
たしかプロジェクトマネジメント的な役割を「気合ですすめたい」と言っていることが複数回あった。

気合という言葉はどういう認識で発しているのだろう？
もしかしたら、プロジェクトマネジメントにおいて必要な事柄を適切に理解できていない=誤って理解しているのかもしれない。

他チームとの関わりはあんまりやってない気がするね、algo とかコンテンツとか。
ひょっとしたら、いま ux に聞かずに「いいっしょ」でやっていることが、他チームとの関わりでも起きるとすると、
ちゃんとその姿勢を修正しておくべきなのかもしれない。

05-17 に「長野いくのやめてコマンド修正します」はいい判断だった。

極めて具体的な問題に対してコードで解決する能力はどうだろう？
patch 問題の暫定対応の PR をつくるのすごくはやかった。
コーディングの能力は僕とほぼ変わらないと思う。
（a+のコードに対する理解が少し僕より少ないということはあるかもだけど）
ここらへんは PR をみてみて確認するといいかもしれない。

テストに関して「とりあえず書いてみよう」のままで、戦略的に社内に広げていくうえで何が課題か、みたいなことの解像度が低い気がする。

課題は以下かな？

- 「これでいいでしょ」の過度な楽観をせず、適切にリスクを潰す
- 他チームとの関わり（これは単純に経験が少なそうで、まずはトライから）

# jose

みえないボールをキャッチして動く、というのができてなかった印象
ただし最近いい動きが見える
みやっちに「としさんに答えてなくない？」
daily とかで話している中で決まったことをチケットにメモしてくれていた

みえるものしかみえてない、という印象。
オーバーヘッドが大きい。ささっとやってくれよ、という印象（まずは明示的に、なのかもしれないが。）

別の言い方をすると、言われたことしかやらない。
チケットの背後にあるものを汲み取って、ということができてない。

patch のバグチケで 2 回くらい不適切にチケットを完了にしようとした（結局 incident になった）のもそれ。
2023 年春かな。

2023-05 から一緒に働いているけど、あんまり変化がみられない。

なんか問題解決が下手な印象。
solution にすぐ飛びつく。

本質を捉えてない。中身が空っぽのことばかり言っている。

あと「サーバやりたい」みたいなのも解像度低すぎ。

わく春でサーバ実装したのは自信が少しついたかもしれない。

ただ PR でも極めて初歩的な、

ひょっとしたら jose-san に対するいらだちは、jose-san という問題に対する solution を僕が見つけられていないことに由来するのかもしれない。

ふつうにエンジニアリング能力、具体的な問題に対して方法を調べて考えて実装して解決する能力がかなり低い印象。
kiban に相談して、結局ぺーさんに全部実装してもらうみたいなことが多い。
（ex. わく春のリファクタリング、patch 問題）

わく夏の dev discover もけっきょくあっちゃんにやってもらっている。
